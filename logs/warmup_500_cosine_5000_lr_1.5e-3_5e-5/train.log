Arguments: Namespace(train_data='../data/TinyStoriesV2-GPT4-train.txt', val_data='../data/TinyStoriesV2-GPT4-valid.txt', log_dir='../logs/warmup_500_cosine_5000_lr_1.5e-3_5e-5', checkpoint_dir='../ckpt/warmup_500_cosine_5000_lr_1.5e-3_5e-5', checkpoint_interval=1000, checkpoint_resume_path='', eval_interval=100, num_layers=4, d_model=512, num_heads=16, d_ff=1344, max_seq_length=256, batch_size=32, num_epochs=5000, rope_theta=10000, adamw_beta1=0.9, adamw_beta2=0.999, adamw_eps=1e-08, adamw_weight_decay=0.01, lr=0.001, enable_lr_schedule=True, lr_max=0.0015, lr_min=5e-05, warmup_iters=500, cosine_iters=5000, max_grad_norm=1.0, seed=599)
using device: cuda:0
loading data...
Starting training from epoch 0
Epoch 100, Training Loss: 5.1100, Validation Loss: 5.0318
Epoch 200, Training Loss: 3.3606, Validation Loss: 3.3667
Epoch 300, Training Loss: 2.8721, Validation Loss: 2.8899
Epoch 400, Training Loss: 2.6372, Validation Loss: 2.6693
Epoch 500, Training Loss: 2.6390, Validation Loss: 2.5405
Epoch 600, Training Loss: 2.4112, Validation Loss: 2.4353
Epoch 700, Training Loss: 2.4208, Validation Loss: 2.3469
Epoch 800, Training Loss: 2.2234, Validation Loss: 2.2684
Epoch 900, Training Loss: 2.2791, Validation Loss: 2.2069
Saved checkpoint to ../ckpt/warmup_500_cosine_5000_lr_1.5e-3_5e-5/ckpt1000.pt
Epoch 1000, Training Loss: 2.2351, Validation Loss: 2.1616
Epoch 1100, Training Loss: 2.0784, Validation Loss: 2.1126
Epoch 1200, Training Loss: 2.0913, Validation Loss: 2.0848
Epoch 1300, Training Loss: 1.9347, Validation Loss: 2.0516
Epoch 1400, Training Loss: 2.0361, Validation Loss: 2.0252
Epoch 1500, Training Loss: 1.9555, Validation Loss: 1.9946
Epoch 1600, Training Loss: 1.9964, Validation Loss: 1.9692
Epoch 1700, Training Loss: 1.9186, Validation Loss: 1.9459
Epoch 1800, Training Loss: 1.9031, Validation Loss: 1.9235
Epoch 1900, Training Loss: 1.8072, Validation Loss: 1.9049
Saved checkpoint to ../ckpt/warmup_500_cosine_5000_lr_1.5e-3_5e-5/ckpt2000.pt
Epoch 2000, Training Loss: 1.9083, Validation Loss: 1.8818
Epoch 2100, Training Loss: 1.8224, Validation Loss: 1.8657
Epoch 2200, Training Loss: 1.8165, Validation Loss: 1.8520
Epoch 2300, Training Loss: 1.7080, Validation Loss: 1.8391
Epoch 2400, Training Loss: 1.7311, Validation Loss: 1.8221
Epoch 2500, Training Loss: 1.7080, Validation Loss: 1.8065
Epoch 2600, Training Loss: 1.7620, Validation Loss: 1.7905
Epoch 2700, Training Loss: 1.8274, Validation Loss: 1.7831
Epoch 2800, Training Loss: 1.7268, Validation Loss: 1.7678
Epoch 2900, Training Loss: 1.7029, Validation Loss: 1.7578
Saved checkpoint to ../ckpt/warmup_500_cosine_5000_lr_1.5e-3_5e-5/ckpt3000.pt
Epoch 3000, Training Loss: 1.7194, Validation Loss: 1.7430
Epoch 3100, Training Loss: 1.7292, Validation Loss: 1.7346
Epoch 3200, Training Loss: 1.7056, Validation Loss: 1.7247
Epoch 3300, Training Loss: 1.7473, Validation Loss: 1.7111
Epoch 3400, Training Loss: 1.7694, Validation Loss: 1.7019
Epoch 3500, Training Loss: 1.5555, Validation Loss: 1.6901
Epoch 3600, Training Loss: 1.7030, Validation Loss: 1.6831
Epoch 3700, Training Loss: 1.6857, Validation Loss: 1.6755
Epoch 3800, Training Loss: 1.5360, Validation Loss: 1.6666
Epoch 3900, Training Loss: 1.6084, Validation Loss: 1.6613
Saved checkpoint to ../ckpt/warmup_500_cosine_5000_lr_1.5e-3_5e-5/ckpt4000.pt
Epoch 4000, Training Loss: 1.6646, Validation Loss: 1.6540
Epoch 4100, Training Loss: 1.6829, Validation Loss: 1.6469
Epoch 4200, Training Loss: 1.6717, Validation Loss: 1.6424
Epoch 4300, Training Loss: 1.6220, Validation Loss: 1.6374
Epoch 4400, Training Loss: 1.6210, Validation Loss: 1.6327
Epoch 4500, Training Loss: 1.5884, Validation Loss: 1.6290
Epoch 4600, Training Loss: 1.5200, Validation Loss: 1.6253
Epoch 4700, Training Loss: 1.6060, Validation Loss: 1.6218
Epoch 4800, Training Loss: 1.5706, Validation Loss: 1.6192
Epoch 4900, Training Loss: 1.5245, Validation Loss: 1.6184
Saved checkpoint to ../ckpt/warmup_500_cosine_5000_lr_1.5e-3_5e-5/ckpt5000.pt
Epoch 5000, Training Loss: 1.6032, Validation Loss: 1.6163
